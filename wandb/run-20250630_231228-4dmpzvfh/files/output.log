WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Fitting to AMZN
[34m[1mwandb[0m: [33mWARNING[0m WandbCallback is deprecated and will be removed in a future release. Please use the WandbMetricsLogger, WandbModelCheckpoint, and WandbEvalCallback callbacks instead. See https://docs.wandb.ai/guides/integrations/keras for more information.
[34m[1mwandb[0m: [33mWARNING[0m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
Epoch 1/100
47/47 [==============================] - 7s 88ms/step - loss: 0.1185 - val_loss: 0.0337
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 2/100
47/47 [==============================] - 4s 82ms/step - loss: 0.0394 - val_loss: 0.0061
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 3/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0359 - val_loss: 0.0083
Epoch 4/100
47/47 [==============================] - 4s 79ms/step - loss: 0.0336 - val_loss: 0.0021
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 5/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0338 - val_loss: 0.0107
Epoch 6/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0316 - val_loss: 0.0033
Epoch 7/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0315 - val_loss: 0.0029
Epoch 8/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0320 - val_loss: 0.0079
Epoch 9/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0323 - val_loss: 0.0083
Epoch 10/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0335 - val_loss: 0.0062
Epoch 11/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0314 - val_loss: 0.0057
Epoch 12/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0309 - val_loss: 0.0039
Epoch 13/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0311 - val_loss: 0.0063
Epoch 14/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0293 - val_loss: 0.0024
Epoch 15/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0302 - val_loss: 0.0091
Epoch 16/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0305 - val_loss: 0.0026
Epoch 17/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0303 - val_loss: 0.0099
Epoch 18/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0295 - val_loss: 0.0037
Epoch 19/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0288 - val_loss: 0.0062
Epoch 20/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0311 - val_loss: 0.0053
Epoch 21/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0293 - val_loss: 0.0052
Epoch 22/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0300 - val_loss: 0.0038
Epoch 23/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0293 - val_loss: 0.0041
Epoch 24/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0299 - val_loss: 0.0096
Epoch 25/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0290 - val_loss: 0.0036
Epoch 26/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0296 - val_loss: 0.0137
Epoch 27/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0299 - val_loss: 0.0032
Epoch 28/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0285 - val_loss: 0.0032
Epoch 29/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0285 - val_loss: 0.0115
Epoch 30/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0279 - val_loss: 0.0049
Epoch 31/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0285 - val_loss: 0.0022
Epoch 32/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0272 - val_loss: 0.0063
Epoch 33/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0277 - val_loss: 0.0048
Epoch 34/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0267 - val_loss: 0.0026
Epoch 35/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0269 - val_loss: 0.0066
Epoch 36/100
47/47 [==============================] - 4s 82ms/step - loss: 0.0257 - val_loss: 0.0018
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 37/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0262 - val_loss: 0.0029
Epoch 38/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0268 - val_loss: 0.0026
Epoch 39/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0264 - val_loss: 0.0040
Epoch 40/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0259 - val_loss: 0.0069
Epoch 41/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0266 - val_loss: 0.0022
Epoch 42/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0248 - val_loss: 0.0055
Epoch 43/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0265 - val_loss: 0.0052
Epoch 44/100
47/47 [==============================] - 4s 80ms/step - loss: 0.0272 - val_loss: 0.0018
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 45/100
47/47 [==============================] - 4s 80ms/step - loss: 0.0259 - val_loss: 0.0018
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 46/100
47/47 [==============================] - 3s 75ms/step - loss: 0.0253 - val_loss: 0.0017
[34m[1mwandb[0m: Adding directory to artifact (/home/bangbui/Documents/Stock-Predict/wandb/run-20250630_231228-4dmpzvfh/files/model-best)... Done. 0.0s
Epoch 47/100
47/47 [==============================] - 1s 24ms/step - loss: 0.0256 - val_loss: 0.0028
Epoch 48/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0249 - val_loss: 0.0018
Epoch 49/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0259 - val_loss: 0.0021
Epoch 50/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0256 - val_loss: 0.0027
Epoch 51/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0255 - val_loss: 0.0023
Epoch 52/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0249 - val_loss: 0.0023
Epoch 53/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0267 - val_loss: 0.0019
Epoch 54/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0264 - val_loss: 0.0059
Epoch 55/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0259 - val_loss: 0.0031
Epoch 56/100
47/47 [==============================] - 1s 24ms/step - loss: 0.0256 - val_loss: 0.0020
Epoch 57/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0246 - val_loss: 0.0022
Epoch 58/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0260 - val_loss: 0.0030
Epoch 59/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0250 - val_loss: 0.0033
Epoch 60/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0246 - val_loss: 0.0020
Epoch 61/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0246 - val_loss: 0.0028
Epoch 62/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0247 - val_loss: 0.0031
Epoch 63/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0250 - val_loss: 0.0027
Epoch 64/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0241 - val_loss: 0.0023
Epoch 65/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0254 - val_loss: 0.0018
Epoch 66/100
47/47 [==============================] - 1s 21ms/step - loss: 0.0248 - val_loss: 0.0018
Epoch 67/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0248 - val_loss: 0.0023
Epoch 68/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0244 - val_loss: 0.0035
Epoch 69/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0245 - val_loss: 0.0028
Epoch 70/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0257 - val_loss: 0.0020
Epoch 71/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0259 - val_loss: 0.0019
Epoch 72/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0248 - val_loss: 0.0031
Epoch 73/100
47/47 [==============================] - 1s 22ms/step - loss: 0.0249 - val_loss: 0.0018
Epoch 74/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0238 - val_loss: 0.0018
Epoch 75/100
47/47 [==============================] - 1s 25ms/step - loss: 0.0246 - val_loss: 0.0023
Epoch 76/100
47/47 [==============================] - 1s 26ms/step - loss: 0.0241 - val_loss: 0.0031
Epoch 77/100
47/47 [==============================] - 1s 26ms/step - loss: 0.0244 - val_loss: 0.0018
Epoch 78/100
47/47 [==============================] - 1s 24ms/step - loss: 0.0253 - val_loss: 0.0018
Epoch 79/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0236 - val_loss: 0.0029
Epoch 80/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0239 - val_loss: 0.0020
Epoch 81/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0238 - val_loss: 0.0021
Epoch 82/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0237 - val_loss: 0.0018
Epoch 83/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0258 - val_loss: 0.0024
Epoch 84/100
47/47 [==============================] - 1s 26ms/step - loss: 0.0243 - val_loss: 0.0018
Epoch 85/100
47/47 [==============================] - 1s 26ms/step - loss: 0.0240 - val_loss: 0.0020
Epoch 86/100
47/47 [==============================] - 1s 25ms/step - loss: 0.0244 - val_loss: 0.0019
Epoch 87/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0243 - val_loss: 0.0019
Epoch 88/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0237 - val_loss: 0.0022
Epoch 89/100
47/47 [==============================] - 1s 25ms/step - loss: 0.0243 - val_loss: 0.0040
Epoch 90/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0247 - val_loss: 0.0069
Epoch 91/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0243 - val_loss: 0.0045
Epoch 92/100
47/47 [==============================] - 1s 25ms/step - loss: 0.0245 - val_loss: 0.0041
Epoch 93/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0236 - val_loss: 0.0050
Epoch 94/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0237 - val_loss: 0.0018
Epoch 95/100
47/47 [==============================] - 1s 24ms/step - loss: 0.0241 - val_loss: 0.0020
Epoch 96/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0238 - val_loss: 0.0048
Epoch 97/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0234 - val_loss: 0.0028
Epoch 98/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0231 - val_loss: 0.0032
Epoch 99/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0240 - val_loss: 0.0024
Epoch 100/100
47/47 [==============================] - 1s 23ms/step - loss: 0.0252 - val_loss: 0.0053
